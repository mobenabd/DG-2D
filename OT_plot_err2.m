clear; clc; close all;
all_marks = {'o','+','*','s','^','p'};
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Verifier la vitesse de convergence pour le cas 1 SaumierThesis + residus 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


l2_error_16 = [0.447214, 0.251144, 0.149115,0.094622, 0.062779, 0.038373, 0.024586, 0.015088, 0.011320, 0.011584, 0.018218, 0.038429, 0.066378,  ...
0.075142, 0.059874, 0.024182, 0.013060, 0.011398, 0.012520, 0.011081, 0.009284, 0.008884, 0.008866, 0.008835, 0.008832, 0.008818, 0.008820, ...
0.008813, 0.008815, 0.008811, 0.008812, 0.008811, 0.008812, 0.008810, 0.008811, 0.008811, 0.008811, 0.008811, 0.008811, 0.008811, 0.008811,  ...
0.008811, 0.008811, 0.008811, 0.008811, 0.008811, 0.008811, 0.008811, 0.008811];


residu_16 = [1.000000, 0.346703, 0.157019, 0.081951, 0.058377, 0.030830, 0.021726, 0.010574, 0.005400, 0.003709, 0.006027, 0.011314, 0.015568, ...
0.014685, 0.008989, 0.003614, 0.001830, 0.001867, 0.001710, 0.001080, 0.000444, 0.000247, 0.000181, 0.000147, 0.000110, 0.000088, 0.000067, ... 
0.000053, 0.000041, 0.000032, 0.000025, 0.000019, 0.000015, 0.000012, 0.000009, 0.000007, 0.000006, 0.000004, 0.000003, 0.000003, 0.000002, ...
0.000002, 0.000001, 0.000001, 0.000001, 0.000001, 0.000000, 0.000000, 0.000000];


l2_error_8 = [0.447211, 0.257357, 0.154545, 0.098773, 0.070412, 0.054791, 0.047062, 0.049676, 0.051188, 0.083744, 0.100880, 0.103574,  ...
0.063998, 0.047628, 0.044027, 0.045768, 0.044051, 0.045042, 0.044307, 0.044494, 0.044364, 0.044494, 0.044394, 0.044439, 0.044425, 0.044436, ...
0.044426, 0.044434, 0.044430, 0.044432, 0.044431, 0.044432, 0.044431, 0.044432, 0.044431, 0.044431, 0.044431, 0.044431, 0.044431, 0.044431, ...
0.044431, 0.044431, 0.044431, 0.044431, 0.044431, 0.044431, 0.044431, 0.044431, 0.044431];


residu_8 = [1.000000,0.355399,0.162781,0.081504,0.055977,0.028509,0.020527,0.015446,0.025196,0.040762,0.046748,0.035398,0.016285,0.005106, ...
0.003550,0.003486,0.002614,0.001210,0.000385,0.000291,0.000265,0.000207,0.000094,0.000033,0.000025,0.000022,0.000017,0.000008,0.000004, ...
0.000003,0.000002,0.000002,0.000002,0.000001,0.000001,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000, ...
0.000000,0.000000,0.000000,0.000000,0.000000];



alpha_8 = [0.5, 0.500000,0.500000,0.500000,0.625000,0.625000,0.781250,0.781250,0.781250,0.625000,0.500000,0.400000,0.320000,0.400000, ...
0.500000,0.500000,0.400000,0.320000,0.400000,0.500000,0.500000,0.400000,0.320000,0.400000,0.500000,0.500000,0.400000,0.320000,0.400000, ...
0.500000,0.500000,0.500000,0.500000,0.400000,0.320000,0.400000,0.500000,0.500000,0.500000,0.500000,0.500000,0.400000,0.320000,0.400000, ...
0.500000,0.500000,0.500000,0.500000,0.500000];

alpha_16 = [0.5, 0.500000,0.500000,0.500000,0.625000,0.625000,0.781250,0.781250,0.781250,0.781250,0.781250,0.625000,0.500000,0.400000,0.320000,...
0.320000,0.400000,0.500000,0.400000,0.320000,0.320000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000, ...
0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000,0.400000, ...
0.400000,0.400000,0.400000,0.400000];



it = 1:49;


figure(1)
semilogy(it, l2_error_8, 'marker',all_marks{3}, 'LineStyle', '-.', 'LineWidth',1.5, 'markersize', 4)
hold on
semilogy(it, l2_error_16, 'marker',all_marks{4}, 'LineStyle', '-.', 'LineWidth',1.5, 'markersize', 4)
grid on
hold off
xlabel('iterations')
ylabel('error-norm L2')
legend('$N=8^2$', '$N=16^2$', 'interpreter','latex', 'fontsize', 12)

figure(2)
semilogy(it, residu_8, 'marker',all_marks{3}, 'LineStyle', '-.', 'LineWidth',1.5, 'markersize', 4)
hold on
semilogy(it, residu_16, 'marker',all_marks{4}, 'LineStyle', '-.', 'LineWidth',1.5, 'markersize', 4)
grid on
xlabel('iterations')
ylabel('residual')
legend('$N=8^2$', '$N=16^2$', 'interpreter','latex', 'fontsize', 12)


figure(3)
semilogy(it, alpha_8, 'marker',all_marks{3}, 'LineStyle', '-.', 'LineWidth',1.5, 'markersize', 4)
hold on
semilogy(it, alpha_16, 'marker',all_marks{4}, 'LineStyle', '-.', 'LineWidth',1.5, 'markersize', 4)
grid on
xlabel('iterations')
ylabel('step size $\alpha$', 'interpreter','latex', 'fontsize', 12)
legend('$N=8^2$', '$N=16^2$', 'interpreter','latex', 'fontsize', 12)



