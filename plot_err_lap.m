clear
clc
close all

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% Verifier l'ordre de convergence sur le laplacien au sens faible %%%%
%%%%% on résount u_t-Δu = f puis on calcule le laplacien projeté  %%%%%%%%
%%%%% la solution exacte est Δu = u_t - f %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%% sous la version 1 de 'basis.m'' (fonctions de bases EF continues) %%

%%% u_exct(x,y,t) = sin(2pix)*sin(2piy)*cos(pi/2*t)
%%% dt = 0.001
%%% T_final = 20*dt
%%% eps=-1, sigma =100


%%%  k=1, SIPG, 20
n_k1 = [4 8 16 32];
err2_k1 =[0.1094875134 0.0260338243 0.0064141721 0.0016006533]; %w.r.t u
err2_k1 =[5.2767455166 1.3665418780 0.3442222543 0.0860960529]; %w.r.t lap(u)

%%% k=1, NIPG,20
err2_k1 =[0.1072706189 0.0253669771 0.0062520920 0.0015615745]; %w.r.t u
err2_k1 =[5.2652842831 1.3602088155 0.3425017267 0.0856751733]; %w.r.t lap(u)

coeff_k1 = polyfit(log(1./n_k1),log(err2_k1),1)



%%%  k=2,  SIPG, 20
n_k2 = [4 8 16 32];
%err2_k2 =[0.0137576721 0.0018514294 0.0002360420 0.0000303804]; %w.r.t u
%err2_k2 =[0.7060149789 0.0914784334 0.0115442153 0.0015156068]; %w.r.t lap(u)


%%%  k=2,  NIPG, 20
%err2_k2 =[0.0140218215 0.0019517510 0.0002675039 0.0000440236]; %w.r.t u
err2_k2 =[0.7124581717 0.0927359749 0.0118068850 0.0014574836]; %w.r.t lap(u)

%%% 100
%err2_k2 = [0.0144149952 0.0020077417 0.0002848276 0.0000513244];
%err2_k2 = [0.6941326533 0.0902861013 0.0114218173 0.0015561977];

coeff_k2 = polyfit(log(1./n_k2),log(err2_k2),1)



return
%%%  k=3, SIPG, 20
n_k3 = [2 4 8 16];
%err2_k3 =[0.0255430874 0.0013212266 0.0000878209 0.0000081990]; %w.r.t u
% err2_k3 =[1.4378564630 0.0710164675 0.0044536064 0.0005506574]; %w.r.t lap(u)

%%% 100
err2_k3 = [0.0255200231 0.0013071378 0.0000870100 0.0000095407];
err2_k3 = [1.4166442584 0.0701880166 0.0044242173 0.0006740493];



%%%  k=3, NIPG, 20
%err2_k3 =[0.0275591574 0.0013978901 0.0000904819 0.0000087186]; %w.r.t u
%err2_k3 =[1.4536746852 0.0711718390 0.0044282698 0.0005364553]; %w.r.t lap(u)

%%% 100
err2_k3 = [0.0285251422 0.0014007740 0.0000908296 0.0000102788];
err2_k3 = [1.4166369774 0.0701885612 0.0044246082 0.0006741858];
coeff_k3 = polyfit(log(1./n_k3),log(err2_k3),1)
